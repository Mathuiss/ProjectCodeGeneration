<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>NFBC HOME</title>
    <link rel="stylesheet" href="Style.css">

    <script src="https://code.jquery.com/jquery-3.4.1.js"></script>
    <script>
        if (sessionStorage.getItem('sessionToken') == null) {
            location.href = "index.html";
        }
    </script>
</head>

<body>

    <input id="logout" type="submit" value="logout">

    <input type="submit" value="Accounts" id="redirect-accounts">
    <input type="submit" value="Transactions" id="redirect-transactions">
</body>


<script>
    document.getElementById("redirect-transactions").addEventListener("click", function () {
        location.href = "transactions.html";
    });

    document.getElementById("redirect-accounts").addEventListener("click", function () {
        location.href = "accounts.html";
    });

    document.getElementById("users").addEventListener("click", function () {
        location.href = "users.html";
    });

    document.getElementById("logout").addEventListener("click", function () {
        var url = "/logout"

        active = sessionStorage.getItem("active")
        sessionToken = sessionStorage.getItem('sessionToken');
        user = sessionStorage.getItem('user');
        userRole = sessionStorage.getItem('userRole');
        timestamp = sessionStorage.getItem('timestamp');
        isActive = sessionStorage.getItem('isActive');

        $.ajax({
            method: "POST",
            url: url,
            contentType: "application/json",
            data: JSON.stringify({
                "active": active,
                "sessionToken": sessionToken,
                "user": user,
                "userRole": userRole,
                "timestamp": timestamp,
                "isActive": isActive
            }),
            success: function () {
                sessionStorage.clear();
                alert('you are logged out');
                location.href = "index.html";
            },
            statusCode: {
                400: function () {
                    alert("Bad request");

                    sessionStorage.clear();
                    location.href = "index.html";
                },
                401: function () {
                    alert("Unauthorized");

                    sessionStorage.clear();
                    location.href = "index.html";
                }
            }
        })
    });
</script>

</html>