<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Accounts</title>
    <script src="https://code.jquery.com/jquery-3.4.1.js"></script>
</head>

<body>

    <input id="get" type="submit" value="Get all accounts">
    <input id="getIban" type="submit" value="Get single account">
    <input id="create" type="submit" value="Create new account">
    <input id="delete" type="submit" value="Delete account">
    <input id="update" type="submit" value="Update account">

    <div id="query-box">
        <form>
            <label id="iban">iban</label>
            <input id="iban" name="iban" type="text">

            <label id="userId">user ID</label>
            <input id="userId" name="userId" type="number">

            <label id="isActive">is active</label>
            <input id="isActive" name="isActive" type="text">

            <label id="accountType">account type</label>
            <input id="accountType" name="accountType" type="text">

            <label id="balance">balance</label>
            <input id="balance" name="balance" type="number">

            <label id="absoluteLimit">absolute limit</label>
            <input id="absoluteLimit" name="absoluteLimit" type="number">

            <label id="dailyLimit">daily limit</label>
            <input id="dailyLimit" name="dailyLimit" type="number">

            <label id="transactionLimit">transaction limit</label>
            <input id="transactionLimit" name="transactionLimit" type="number">
        </form>
    </div>
    <ul id="content"></ul>
</body>

<script>

    document.getElementById("get").addEventListener("click", function () {
        var url = "http://localhost:8080/accounts";
        var key = sessionStorage.getItem("ApiKeyAuth");

        // var json = "{";

        // if (document.getElementById("accountType").value != "") {
        //     json += '"accountType": "' + document.getElementById("accountType").value + '",';
        // }

        // json += "}";
        // json = json.replace(",}", "}");

        // console.log("accountType: " + document.getElementById("accountType").value);

        // if (sessionStorage.getItem("userRole") == "employee") {
        $.ajax({
            method: "GET",
            url: url,
            //data: JSON.parse(json),
            headers: {
                "session": key
            },
            success: function (accounts) {
                console.log("success");
                $.each(accounts, function (i, item) {
                    document.getElementById("content").innerHTML += "<li>iban: " + item.iban + " ";
                    document.getElementById("content").innerHTML += "userId: " + item.userId + " ";
                    document.getElementById("content").innerHTML += "active: " + item.isActive + " ";
                    document.getElementById("content").innerHTML += "account type: " + item.accountType + " ";
                    document.getElementById("content").innerHTML += "balance: " + item.balance + " ";
                    document.getElementById("content").innerHTML += "absolute limit: " + item.absoluteLimit + " ";
                    document.getElementById("content").innerHTML += "daily limit: " + item.dailyLimit + " ";
                    document.getElementById("content").innerHTML += "transaction limit: " + item.transactionLimit + "</li>";
                })
            },
            statusCode: {
                400: function () {
                    alert("Bad request");
                },
                401: function () {
                    alert("Unauthorized");
                },
                404: function () {
                    alert("Not found");
                }
            }
        });
        // }
        // else {
        //     alert("Not found");
        // };

        document.getElementById("getIban").addEventListener("click", function () {
            var path = $("#iban").val().trim();
            //var path = "NL00INHO0000000003";
            var url = "http://localhost:8080/accounts/" + path;
            var key = sessionStorage.getItem("ApiKeyAuth");

            var json = "{";

            if (document.getElementById("iban").value != "") {
                json += '"iban": ' + document.getElementById("iban").value + '"';
            }

            json += "}";
            json = json.replace(",}", "}");

            $.ajax({
                method: "GET",
                url: url,
                data: JSON.parse(json),
                headers: {
                    "session": key
                },
                success: function (accounts) {
                    console.log("success");
                    $.each(accounts, function (i, item) {
                        document.getElementById("content").innerHTML += "<li>iban: " + item.iban + " ";
                        document.getElementById("content").innerHTML += "userId: " + item.userId + " ";
                        document.getElementById("content").innerHTML += "active: " + item.isActive + " ";
                        document.getElementById("content").innerHTML += "account type: " + item.accountType + " ";
                        document.getElementById("content").innerHTML += "balance: " + item.balance + " ";
                        document.getElementById("content").innerHTML += "absolute limit: " + item.absoluteLimit + " ";
                        document.getElementById("content").innerHTML += "daily limit: " + item.dailyLimit + " ";
                        document.getElementById("content").innerHTML += "transaction limit: " + item.transactionLimit + "</li>";
                    })
                },
                statusCode: {
                    400: function () {
                        alert("Bad request");
                    },
                    401: function () {
                        alert("Unauthorized");
                    }
                }
            })
        });

        document.getElementById("create").addEventListener("click", function () {

        });

        document.getElementById("delete").addEventListener("click", function () {

        });

        document.getElementById("update").addEventListener("click", function () {

        });
    })


</script>

</html>